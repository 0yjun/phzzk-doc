# 스트리머 방송 시작 시나리오

### 1. 스트리머가 방송을 시작한다 
- **(Web 서버 → WAS 서버)**:
  - Web 서버는 사용자 인터페이스(UI)를 제공
  - WAS 서버는 방송 시작을 처리

### 2. 방송 정보가 기록된다 
- **(WAS 서버)**:
  - WAS 서버는 방송의 메타데이터를 기록

### 3. 스트리밍 서버가 실시간 스트림을 변환한다
- **(WAS 서버 → 스트리밍 서버)**:
  - WAS 서버가 스트리밍 서버에 스트리머의 스트림 전송 시작을 지시
  - 스트리밍 서버가 실시간으로 스트림을 인코딩/변환

### 4. 스트리밍 서버가 실시간 스트림을 시청자에게 전송한다 
- **(스트리밍 서버 → 시청자)**:
  - 스트리밍 서버가 변환된 스트림을 시청자에게 실시간 전송

### 5. 스트리밍 서버가 실시간 스트림을 미디어 저장 서버로 보낸다 
- **(스트리밍 서버 → 미디어 저장 서버)**:
  - 스트리밍 서버가 실시간 스트림을 녹화본으로 저장
  -  녹화본은 /data/yyyy/mm/dd/hh 경로에 yyyyddmmhh_uuid로 저장된다.
# 채팅 기능 활성화

### 1. 실시간 채팅 관리 
- **(Web 서버 → WAS 서버 → WebSocket)**:
  - WAS 서버가 WebSocket을 통해 실시간 채팅을 관리

### 2. 시청자가 채팅을 입력한다 
- **(시청자 → Web 서버 → WAS 서버)**:
  - 시청자가 WebSocket을 통해 실시간으로 메시지를 전송

### 3. 스트리머가 채팅에 응답한다 
- **(스트리머 → Web 서버 → WAS 서버 → 시청자)**:
  - 스트리머가 WebSocket을 통해 실시간으로 채팅에 응답

```scss
sequenceDiagram
    participant Web as Web 서버
    participant WAS as WAS 서버
    participant SS as 스트리밍 서버
    participant MS as 미디어 저장 서버
    participant Streamer as 스트리머
    participant Viewer as 시청자

    Streamer->>Web: 방송 시작 버튼 클릭
    Web->>WAS: 방송 시작 요청
    WAS-->>WAS: 방송 메타데이터 기록
    WAS->>SS: 스트림 전송 시작 지시
    SS-->>SS: 스트림 인코딩 및 변환
    SS->>Viewer: 실시간 스트림 전송
    SS->>MS: 스트림 녹화본 저장
```
![mermaid-diagram-2024-10-10-235517](https://github.com/user-attachments/assets/4b8585d3-89ce-477d-a234-750394139045)

